{
	"name": "LoadDimAndFactTable",
	"properties": {
		"content": {
			"query": "-- Create DimDate Table\nCREATE TABLE DimDate (\n    DateKey INT NOT NULL, -- YYYYMMDD\n    FullDate DATE NOT NULL,\n    DayNumberOfWeek INT,\n    DayNameOfWeek NVARCHAR(50),\n    DayOfMonth INT,\n    MonthName NVARCHAR(50),\n    MonthNumberOfYear INT,\n    Year INT\n)\nWITH (DISTRIBUTION = ROUND_ROBIN);\n\n-- Create DimProduct Table\nCREATE TABLE DimProduct (\n    ProductKey INT NOT NULL,\n    ProductName NVARCHAR(100),\n    ProductCategory NVARCHAR(100),\n    ProductSubcategory NVARCHAR(100),\n    ProductSKU NVARCHAR(50)\n)\nWITH (DISTRIBUTION = HASH(ProductKey));\n\n-- Create DimCustomer Table\nCREATE TABLE DimCustomer (\n    CustomerKey INT NOT NULL,\n    FirstName NVARCHAR(100),\n    LastName NVARCHAR(100),\n    Gender CHAR(1),\n    EmailAddress NVARCHAR(100),\n    PhoneNumber NVARCHAR(15),\n    AddressLine1 NVARCHAR(255),\n    City NVARCHAR(100),\n    State NVARCHAR(50),\n    PostalCode NVARCHAR(20),\n    Country NVARCHAR(50)\n)\nWITH (DISTRIBUTION = HASH(CustomerKey));\n\n-- Create FactSales Table\nCREATE TABLE FactSales (\n    SalesKey BIGINT IDENTITY(1,1) NOT NULL,\n    DateKey INT NOT NULL,\n    ProductKey INT NOT NULL,\n    CustomerKey INT NOT NULL,\n    SalesAmount DECIMAL(18, 2),\n    QuantitySold INT,\n    DiscountAmount DECIMAL(18, 2),\n    TotalAmount DECIMAL(18, 2)\n)\nWITH (DISTRIBUTION = ROUND_ROBIN);\n\n\n\n\n-- Inserting the data\n\n-- Insert Dates from 2024-01-01 to 2199-12-31\nDECLARE @StartDate DATE = '2024-01-01';\nDECLARE @EndDate DATE = '2199-12-31';\n\n-- Generate a series of numbers to represent days\nWITH Numbers AS (\n    SELECT TOP (DATEDIFF(DAY, @StartDate, @EndDate) + 1) \n        ROW_NUMBER() OVER (ORDER BY (SELECT NULL)) - 1 AS Num\n    FROM sys.all_objects\n)\nINSERT INTO DimDate (DateKey, FullDate, DayNumberOfWeek, DayNameOfWeek, DayOfMonth, MonthName, MonthNumberOfYear, Year)\nSELECT \n    CONVERT(INT, CONVERT(VARCHAR(8), DATEADD(DAY, Num, @StartDate), 112)) AS DateKey,\n    DATEADD(DAY, Num, @StartDate) AS FullDate,\n    DATEPART(WEEKDAY, DATEADD(DAY, Num, @StartDate)) AS DayNumberOfWeek,\n    DATENAME(WEEKDAY, DATEADD(DAY, Num, @StartDate)) AS DayNameOfWeek,\n    DATEPART(DAY, DATEADD(DAY, Num, @StartDate)) AS DayOfMonth,\n    DATENAME(MONTH, DATEADD(DAY, Num, @StartDate)) AS MonthName,\n    DATEPART(MONTH, DATEADD(DAY, Num, @StartDate)) AS MonthNumberOfYear,\n    DATEPART(YEAR, DATEADD(DAY, Num, @StartDate)) AS Year\nFROM Numbers;\n\n\n-- Insert Products\n-- Insert Products into DimProduct\nINSERT INTO DimProduct (ProductKey, ProductName, ProductCategory, ProductSubcategory, ProductSKU)\nVALUES (1, 'Laptop', 'Electronics', 'Computers', 'SKU001');\n\nINSERT INTO DimProduct (ProductKey, ProductName, ProductCategory, ProductSubcategory, ProductSKU)\nVALUES (2, 'Smartphone', 'Electronics', 'Mobiles', 'SKU002');\n\nINSERT INTO DimProduct (ProductKey, ProductName, ProductCategory, ProductSubcategory, ProductSKU)\nVALUES (3, 'Tablet', 'Electronics', 'Computers', 'SKU003');\n\nINSERT INTO DimProduct (ProductKey, ProductName, ProductCategory, ProductSubcategory, ProductSKU)\nVALUES (4, 'TV', 'Electronics', 'Home Entertainment', 'SKU004');\n\nINSERT INTO DimProduct (ProductKey, ProductName, ProductCategory, ProductSubcategory, ProductSKU)\nVALUES (5, 'Headphones', 'Electronics', 'Accessories', 'SKU005');\n\n\n\n-- Insert Customers\n-- Insert Customers into DimCustomer\nINSERT INTO DimCustomer (CustomerKey, FirstName, LastName, Gender, EmailAddress, PhoneNumber, AddressLine1, City, State, PostalCode, Country)\nVALUES (1, 'John', 'Doe', 'M', 'john.doe@example.com', '1234567890', '123 Elm St', 'Metropolis', 'CA', '90210', 'USA');\n\nINSERT INTO DimCustomer (CustomerKey, FirstName, LastName, Gender, EmailAddress, PhoneNumber, AddressLine1, City, State, PostalCode, Country)\nVALUES (2, 'Jane', 'Smith', 'F', 'jane.smith@example.com', '0987654321', '456 Oak St', 'Gotham', 'NY', '10001', 'USA');\n\n\n-- Populate FactSales with dummy data\nINSERT INTO FactSales (DateKey, ProductKey, CustomerKey, SalesAmount, QuantitySold, DiscountAmount, TotalAmount)\nSELECT\n    d.DateKey,\n    p.ProductKey,\n    c.CustomerKey,\n    CAST(ABS(CHECKSUM(NEWID()) % 5000 + 1) AS DECIMAL(18, 2)) AS SalesAmount, -- Random Sales Amount\n    ABS(CHECKSUM(NEWID()) % 10 + 1) AS QuantitySold, -- Random Quantity between 1 and 10\n    CAST(ABS(CHECKSUM(NEWID()) % 500) AS DECIMAL(18, 2)) AS DiscountAmount, -- Random Discount\n    (CAST(ABS(CHECKSUM(NEWID()) % 5000 + 1) AS DECIMAL(18, 2)) - CAST(ABS(CHECKSUM(NEWID()) % 500) AS DECIMAL(18, 2))) AS TotalAmount\nFROM DimDate d\nCROSS JOIN DimProduct p\nCROSS JOIN DimCustomer c;\n\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "Datawarehouse_poc",
				"poolName": "Datawarehouse_poc"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}